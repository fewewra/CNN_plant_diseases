# CNN_plant_diseases. Классификация болезней растений с помощью EfficientNetB0

### Выпускная квалификационная работа

## Обзор проекта

Данный репозиторий содержит исходный код и артефакты, полученные в ходе выполнения выпускной квалификационной работы на тему **"Разработка и исследование модели для классификации болезней сельскохозяйственных культур"**.

Проект представляет собой реализацию конвейера машинного обучения для диагностики 38 различных классов состояний растений по фотографиям их листьев. В качестве основной архитектуры была выбрана современная сверточная нейронная сеть **EfficientNetB0** с применением техник **трансферного обучения** и **тонкой настройки (fine-tuning)**.

Итоговая модель, обученная на наборе данных PlantVillage, достигла точности **95.98%** на независимой тестовой выборке.

## Структура репозитория

Репозиторий содержит два Jupyter-ноутбука, которые представляют собой последовательные этапы работы над проектом. Разделение на два файла обусловлено ограничениями на использование вычислительных ресурсов (GPU) в облачной среде Google Colaboratory.

### 1. `Plant_Disease_Classification_Main.ipynb`

Этот ноутбук содержит основную часть работы, включая полный цикл обучения и финальную оценку.

**Содержание ноутбука:**
- **Подготовка среды:** Загрузка датасета PlantVillage с Kaggle.
- **Предобработка данных:** Создание высокопроизводительного конвейера данных с помощью `tf.data`, включая методы аугментации.
- **Фаза 1: Трансферное обучение:** Обучение "головы" модели на "замороженной" базе EfficientNetB0 (20 эпох).
- **Фаза 2: Fine-tuning (Часть 1):** Тонкая настройка верхних слоев модели (первые 5 эпох из 10 запланированных). Сессия была прервана из-за лимитов Colab.
- **Финальная оценка:** Оценка лучшей модели на тестовой выборке (выполнена на CPU).
- **Анализ ошибок:** Построение **матрицы ошибок** и **отчета о классификации** (`classification_report`).

> **Примечание:** Этот ноутбук содержит финальные метрики и артефакты для анализа, так как в нем был выполнен этап оценки.

### 2. `Plant_Disease_Classification_FineTune_Continue.ipynb`

Этот ноутбук является продолжением предыдущего и был использован для дальнейшей тонкой настройки модели в новой сессии Google Colab.

**Содержание ноутбука:**
- **Подготовка среды и загрузка данных:** Аналогично первому ноутбуку.
- **Загрузка весов:** Модель инициализируется весами, сохраненными на лучшей эпохе предыдущего ноутбука.
- **Фаза 2: Fine-tuning (Продолжение):** Процесс тонкой настройки был продолжен и выполнен в течение еще 7 эпох (также прерван из-за лимитов).
- **Построение графиков:** В этом ноутбуке содержится код для генерации **сводных графиков обучения** для обеих фаз (20 + 7 эпох), демонстрирующих общую динамику точности и потерь.

> **Примечание:** Для получения полной картины рекомендуется сначала ознакомиться с основным ноутбуком (`Plant_Disease_Classification_Main.ipynb`) для понимания всего процесса и финальных результатов, а затем с этим ноутбуком для просмотра итоговых графиков истории обучения.

## Использованные технологии и библиотеки

- **Python 3.10**
- **TensorFlow 2.x** / **Keras**
- **EfficientNetB0** (в реализации Keras)
- **Scikit-learn** (для метрик и матрицы ошибок)
- **Matplotlib** / **Seaborn** (для визуализации)
- **Kaggle API** (для загрузки данных)
- **Google Colaboratory** (среда для обучения)

## Как воспроизвести результаты

1.  Клонируйте репозиторий.
2.  Создайте файл `kaggle.json` с вашим API-ключом Kaggle.
3.  Откройте любой из `.ipynb` файлов в Google Colab.
4.  Включите аппаратный ускоритель GPU.
5.  Следуйте инструкциям в ячейках ноутбука для загрузки API-ключа и датасета.
6.  Выполняйте ячейки последовательно.
